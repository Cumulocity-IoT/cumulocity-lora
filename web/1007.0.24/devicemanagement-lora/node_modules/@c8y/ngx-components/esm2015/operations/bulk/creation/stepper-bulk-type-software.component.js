import * as tslib_1 from "tslib";
import { Component, ViewChild } from '@angular/core';
import { C8yStepper, gettext, ModalService, Status } from '@c8y/ngx-components';
import { TranslateService } from '@ngx-translate/core';
import { uniq } from 'lodash-es';
import { BaseStepperComponent } from '../base-stepper.component';
import { SelectSoftwareStepComponent } from './software-update-stepper/select-software-step.component';
let StepperBulkTypeSoftware = class StepperBulkTypeSoftware extends BaseStepperComponent {
    constructor(modal, translate) {
        super();
        this.modal = modal;
        this.translate = translate;
        this.descriptionTemplateSingle = gettext('Update software to: {{ name }} (version {{ version }})');
        this.descriptionTemplateOneOther = gettext('Update software to: {{ name }} (version {{ version }}) and one other');
        this.descriptionTemplateMultiple = gettext('Update software to: {{ name }} (version {{ version }}) and {{ count }} others');
        this.selectedSoftware = [];
    }
    onSoftwareSelected(selectedItem) {
        this.selectedSoftware = this.selectedSoftware.filter(item => item.software.id !== selectedItem.software.id);
        this.selectedSoftware.push(selectedItem);
    }
    confirmSoftwareSelection($event) {
        return tslib_1.__awaiter(this, void 0, void 0, function* () {
            const deviceTypes = this.getUniqueDeviceTypes();
            this.deviceTypes = deviceTypes;
            if (deviceTypes.length > 1) {
                try {
                    yield this.modal.confirm(gettext('Selected software for various device types'), gettext('Operation may fail due to unsupported software. Do you want to proceed?'), Status.WARNING, { ok: gettext('Confirm'), cancel: gettext('Cancel') });
                    $event.stepper.next();
                }
                catch (ex) {
                    this.selectedSoftware = [];
                    this.selectSoftware.resetSelection();
                }
            }
            else {
                $event.stepper.next();
            }
        });
    }
    retrieveOperationPrototype() {
        const softwareList = this.selectedSoftware.map(item => ({
            name: item.software.name,
            version: item.version.c8y_Software.version,
            url: item.version.c8y_Software.url,
            action: item.action
        }));
        const interpolationParams = {
            name: softwareList[0].name,
            version: softwareList[0].version,
            count: softwareList.length - 1
        };
        let description;
        switch (softwareList.length) {
            case 1:
                description = this.translate.instant(this.descriptionTemplateSingle, interpolationParams);
                break;
            case 2:
                description = this.translate.instant(this.descriptionTemplateOneOther, interpolationParams);
                break;
            default:
                description = this.translate.instant(this.descriptionTemplateMultiple, interpolationParams);
        }
        return {
            name: gettext('Software update'),
            prototype: {
                description,
                c8y_SoftwareUpdate: softwareList
            }
        };
    }
    getUniqueDeviceTypes() {
        return uniq(this.selectedSoftware
            .map(item => item.software.c8y_Filter && item.software.c8y_Filter.type)
            .filter(type => !!type));
    }
};
StepperBulkTypeSoftware.ctorParameters = () => [
    { type: ModalService },
    { type: TranslateService }
];
tslib_1.__decorate([
    ViewChild(SelectSoftwareStepComponent, { static: false })
], StepperBulkTypeSoftware.prototype, "selectSoftware", void 0);
StepperBulkTypeSoftware = tslib_1.__decorate([
    Component({
        selector: 'c8y-stepper-bulk-type-software',
        template: "<c8y-bulk-operation-stepper>\n  <ng-container\n    *customStep=\"\n      'Select software' | translate; \n      completed: !!selectedSoftware.length;\n      buttonsDisabled: !selectedSoftware.length; \n      onNext: confirmSoftwareSelection.bind(this)\"\n  >\n    <c8y-select-software-step\n      (software)=\"onSoftwareSelected($event)\"\n      class=\"d-contents\"\n    ></c8y-select-software-step>\n  </ng-container>\n  <ng-container *customStep=\"'Confirm selected software' | translate\">\n    <c8y-confirm-software-selection-step\n      class=\"d-contents\"\n      [selectedItems]=\"selectedSoftware\"\n    ></c8y-confirm-software-selection-step>\n  </ng-container>\n</c8y-bulk-operation-stepper>\n"
    })
], StepperBulkTypeSoftware);
export { StepperBulkTypeSoftware };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RlcHBlci1idWxrLXR5cGUtc29mdHdhcmUuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGM4eS9uZ3gtY29tcG9uZW50cy9vcGVyYXRpb25zLyIsInNvdXJjZXMiOlsiYnVsay9jcmVhdGlvbi9zdGVwcGVyLWJ1bGstdHlwZS1zb2Z0d2FyZS5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUNBLE9BQU8sRUFBRSxTQUFTLEVBQUUsU0FBUyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBRXJELE9BQU8sRUFBRSxVQUFVLEVBQUUsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUNoRixPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUN2RCxPQUFPLEVBQUUsSUFBSSxFQUFFLE1BQU0sV0FBVyxDQUFDO0FBQ2pDLE9BQU8sRUFBRSxvQkFBb0IsRUFBRSxNQUFNLDJCQUEyQixDQUFDO0FBRWpFLE9BQU8sRUFBRSwyQkFBMkIsRUFBRSxNQUFNLDBEQUEwRCxDQUFDO0FBVXZHLElBQWEsdUJBQXVCLEdBQXBDLE1BQWEsdUJBQXdCLFNBQVEsb0JBQW9CO0lBZS9ELFlBQW9CLEtBQW1CLEVBQVUsU0FBMkI7UUFDMUUsS0FBSyxFQUFFLENBQUM7UUFEVSxVQUFLLEdBQUwsS0FBSyxDQUFjO1FBQVUsY0FBUyxHQUFULFNBQVMsQ0FBa0I7UUFkbkUsOEJBQXlCLEdBQVcsT0FBTyxDQUNsRCx3REFBd0QsQ0FDekQsQ0FBQztRQUNPLGdDQUEyQixHQUFXLE9BQU8sQ0FDcEQsc0VBQXNFLENBQ3ZFLENBQUM7UUFDTyxnQ0FBMkIsR0FBVyxPQUFPLENBQ3BELCtFQUErRSxDQUNoRixDQUFDO1FBRUYscUJBQWdCLEdBQXdCLEVBQUUsQ0FBQztJQU0zQyxDQUFDO0lBRUQsa0JBQWtCLENBQUMsWUFBWTtRQUM3QixJQUFJLENBQUMsZ0JBQWdCLEdBQUcsSUFBSSxDQUFDLGdCQUFnQixD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QyxRQUFRLENBQUMsVUFBVSxJQUFJLElBQUksQ0FBQyxRQUFRLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQzthQUN0RSxNQUFNLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQzFCLENBQUM7SUFDSixDQUFDO0NBQ0YsQ0FBQTs7WUF6RTRCLFlBQVk7WUFBcUIsZ0JBQWdCOztBQUY1RTtJQURDLFNBQVMsQ0FBQywyQkFBMkIsRUFBRSxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUUsQ0FBQzsrREFDZDtBQWJqQyx1QkFBdUI7SUFKbkMsU0FBUyxDQUFDO1FBQ1QsUUFBUSxFQUFFLGdDQUFnQztRQUMxQyw0c0JBQXdEO0tBQ3pELENBQUM7R0FDVyx1QkFBdUIsQ0F3Rm5DO1NBeEZZLHVCQUF1QiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENka1N0ZXAgfSBmcm9tICdAYW5ndWxhci9jZGsvc3RlcHBlcic7XG5pbXBvcnQgeyBDb21wb25lbnQsIFZpZXdDaGlsZCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgSU9wZXJhdGlvbiB9IGZyb20gJ0BjOHkvY2xpZW50JztcbmltcG9ydCB7IEM4eVN0ZXBwZXIsIGdldHRleHQsIE1vZGFsU2VydmljZSwgU3RhdHVzIH0gZnJvbSAnQGM4eS9uZ3gtY29tcG9uZW50cyc7XG5pbXBvcnQgeyBUcmFuc2xhdGVTZXJ2aWNlIH0gZnJvbSAnQG5neC10cmFuc2xhdGUvY29yZSc7XG5pbXBvcnQgeyB1bmlxIH0gZnJvbSAnbG9kYXNoLWVzJztcbmltcG9ydCB7IEJhc2VTdGVwcGVyQ29tcG9uZW50IH0gZnJvbSAnLi4vYmFzZS1zdGVwcGVyLmNvbXBvbmVudCc7XG5pbXBvcnQgeyBPcGVyYXRpb25EZXRhaWxzIH0gZnJvbSAnLi4vb3BlcmF0aW9uLWRldGFpbHMubW9kZWwnO1xuaW1wb3J0IHsgU2VsZWN0U29mdHdhcmVTdGVwQ29tcG9uZW50IH0gZnJvbSAnLi9zb2Z0d2FyZS11cGRhdGUtc3RlcHBlci9zZWxlY3Qtc29mdHdhcmUtc3RlcC5jb21wb25lbnQnO1xuaW1wb3J0IHtcbiAgSVNlbGVjdGVkU29mdHdhcmUsXG4gIElTb2Z0d2FyZVVwZGF0ZU9wZXJhdGlvblByb3RvdHlwZVxufSBmcm9tICcuL3NvZnR3YXJlLXVwZGF0ZS1zdGVwcGVyL3NlbGVjdC1zb2Z0d2FyZS5tb2RlbCc7XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ2M4eS1zdGVwcGVyLWJ1bGstdHlwZS1zb2Z0d2FyZScsXG4gIHRlbXBsYXRlVXJsOiAnc3RlcHBlci1idWxrLXR5cGUtc29mdHdhcmUuY29tcG9uZW50Lmh0bWwnXG59KVxuZXhwb3J0IGNsYXNzIFN0ZXBwZXJCdWxrVHlwZVNvZnR3YXJlIGV4dGVuZHMgQmFzZVN0ZXBwZXJDb21wb25lbnQge1xuICByZWFkb25seSBkZXNjcmlwdGlvblRlbXBsYXRlU2luZ2xlOiBzdHJpbmcgPSBnZXR0ZXh0KFxuICAgICdVcGRhdGUgc29mdHdhcmUgdG86IHt7IG5hbWUgfX0gKHZlcnNpb24ge3sgdmVyc2lvbiB9fSknXG4gICk7XG4gIHJlYWRvbmx5IGRlc2NyaXB0aW9uVGVtcGxhdGVPbmVPdGhlcjogc3RyaW5nID0gZ2V0dGV4dChcbiAgICAnVXBkYXRlIHNvZnR3YXJlIHRvOiB7eyBuYW1lIH19ICh2ZXJzaW9uIHt7IHZlcnNpb24gfX0pIGFuZCBvbmUgb3RoZXInXG4gICk7XG4gIHJlYWRvbmx5IGRlc2NyaXB0aW9uVGVtcGxhdGVNdWx0aXBsZTogc3RyaW5nID0gZ2V0dGV4dChcbiAgICAnVXBkYXRlIHNvZnR3YXJlIHRvOiB7eyBuYW1lIH19ICh2ZXJzaW9uIHt7IHZlcnNpb24gfX0pIGFuZCB7eyBjb3VudCB9fSBvdGhlcnMnXG4gICk7XG5cbiAgc2VsZWN0ZWRTb2Z0d2FyZTogSVNlbGVjdGVkU29mdHdhcmVbXSA9IFtdO1xuICBAVmlld0NoaWxkKFNlbGVjdFNvZnR3YXJlU3RlcENvbXBvbmVudCwgeyBzdGF0aWM6IGZhbHNlIH0pXG4gIHNlbGVjdFNvZnR3YXJlOiBTZWxlY3RTb2Z0d2FyZVN0ZXBDb21wb25lbnQ7XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSBtb2RhbDogTW9kYWxTZXJ2aWNlLCBwcml2YXRlIHRyYW5zbGF0ZTogVHJhbnNsYXRlU2VydmljZSkge1xuICAgIHN1cGVyKCk7XG4gIH1cblxuICBvblNvZnR3YXJlU2VsZWN0ZWQoc2VsZWN0ZWRJdGVtKSB7XG4gICAgdGhpcy5zZWxlY3RlZFNvZnR3YXJlID0gdGhpcy5zZWxlY3RlZFNvZnR3YXJlLmZpbHRlcihcbiAgICAgIGl0ZW0gPT4gaXRlbS5zb2Z0d2FyZS5pZCAhPT0gc2VsZWN0ZWRJdGVtLnNvZnR3YXJlLmlkXG4gICAgKTtcbiAgICB0aGlzLnNlbGVjdGVkU29mdHdhcmUucHVzaChzZWxlY3RlZEl0ZW0pO1xuICB9XG5cbiAgYXN5bmMgY29uZmlybVNvZnR3YXJlU2VsZWN0aW9uKCRldmVudDogeyBzdGVwcGVyOiBDOHlTdGVwcGVyOyBzdGVwOiBDZGtTdGVwIH0pIHtcbiAgICBjb25zdCBkZXZpY2VUeXBlczogc3RyaW5nW10gPSB0aGlzLmdldFVuaXF1ZURldmljZVR5cGVzKCk7XG4gICAgdGhpcy5kZXZpY2VUeXBlcyA9IGRldmljZVR5cGVzO1xuICAgIGlmIChkZXZpY2VUeXBlcy5sZW5ndGggPiAxKSB7XG4gICAgICB0cnkge1xuICAgICAgICBhd2FpdCB0aGlzLm1vZGFsLmNvbmZpcm0oXG4gICAgICAgICAgZ2V0dGV4dCgnU2VsZWN0ZWQgc29mdHdhcmUgZm9yIHZhcmlvdXMgZGV2aWNlIHR5cGVzJyksXG4gICAgICAgICAgZ2V0dGV4dCgnT3BlcmF0aW9uIG1heSBmYWlsIGR1ZSB0byB1bnN1cHBvcnRlZCBzb2Z0d2FyZS4gRG8geW91IHdhbnQgdG8gcHJvY2VlZD8nKSxcbiAgICAgICAgICBTdGF0dXMuV0FSTklORyxcbiAgICAgICAgICB7IG9rOiBnZXR0ZXh0KCdDb25maXJtJyksIGNhbmNlbDogZ2V0dGV4dCgnQ2FuY2VsJykgfVxuICAgICAgICApO1xuICAgICAgICAkZXZlbnQuc3RlcHBlci5uZXh0KCk7XG4gICAgICB9IGNhdGNoIChleCkge1xuICAgICAgICB0aGlzLnNlbGVjdGVkU29mdHdhcmUgPSBbXTtcbiAgICAgICAgdGhpcy5zZWxlY3RTb2Z0d2FyZS5yZXNldFNlbGVjdGlvbigpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAkZXZlbnQuc3RlcHBlci5uZXh0KCk7XG4gICAgfVxuICB9XG5cbiAgcHJvdGVjdGVkIHJldHJpZXZlT3BlcmF0aW9uUHJvdG90eXBlKCk6IE9wZXJhdGlvbkRldGFpbHMge1xuICAgIGNvbnN0IHNvZnR3YXJlTGlzdDogSVNvZnR3YXJlVXBkYXRlT3BlcmF0aW9uUHJvdG90eXBlW10gPSB0aGlzLnNlbGVjdGVkU29mdHdhcmUubWFwKGl0ZW0gPT4gKHtcbiAgICAgIG5hbWU6IGl0ZW0uc29mdHdhcmUubmFtZSxcbiAgICAgIHZlcnNpb246IGl0ZW0udmVyc2lvbi5jOHlfU29mdHdhcmUudmVyc2lvbixcbiAgICAgIHVybDogaXRlbS52ZXJzaW9uLmM4eV9Tb2Z0d2FyZS51cmwsXG4gICAgICBhY3Rpb246IGl0ZW0uYWN0aW9uXG4gICAgfSkpO1xuXG4gICAgY29uc3QgaW50ZXJwb2xhdGlvblBhcmFtczogb2JqZWN0ID0ge1xuICAgICAgbmFtZTogc29mdHdhcmVMaXN0WzBdLm5hbWUsXG4gICAgICB2ZXJzaW9uOiBzb2Z0d2FyZUxpc3RbMF0udmVyc2lvbixcbiAgICAgIGNvdW50OiBzb2Z0d2FyZUxpc3QubGVuZ3RoIC0gMVxuICAgIH07XG4gICAgbGV0IGRlc2NyaXB0aW9uOiBzdHJpbmc7XG4gICAgc3dpdGNoIChzb2Z0d2FyZUxpc3QubGVuZ3RoKSB7XG4gICAgICBjYXNlIDE6XG4gICAgICAgIGRlc2NyaXB0aW9uID0gdGhpcy50cmFuc2xhdGUuaW5zdGFudCh0aGlzLmRlc2NyaXB0aW9uVGVtcGxhdGVTaW5nbGUsIGludGVycG9sYXRpb25QYXJhbXMpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgMjpcbiAgICAgICAgZGVzY3JpcHRpb24gPSB0aGlzLnRyYW5zbGF0ZS5pbnN0YW50KHRoaXMuZGVzY3JpcHRpb25UZW1wbGF0ZU9uZU90aGVyLCBpbnRlcnBvbGF0aW9uUGFyYW1zKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICBkZXNjcmlwdGlvbiA9IHRoaXMudHJhbnNsYXRlLmluc3RhbnQodGhpcy5kZXNjcmlwdGlvblRlbXBsYXRlTXVsdGlwbGUsIGludGVycG9sYXRpb25QYXJhbXMpO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiBnZXR0ZXh0KCdTb2Z0d2FyZSB1cGRhdGUnKSxcbiAgICAgIHByb3RvdHlwZTogKHtcbiAgICAgICAgZGVzY3JpcHRpb24sXG4gICAgICAgIGM4eV9Tb2Z0d2FyZVVwZGF0ZTogc29mdHdhcmVMaXN0XG4gICAgICB9IGFzIHVua25vd24pIGFzIElPcGVyYXRpb25cbiAgICB9O1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRVbmlxdWVEZXZpY2VUeXBlcygpOiBzdHJpbmdbXSB7XG4gICAgcmV0dXJuIHVuaXEoXG4gICAgICB0aGlzLnNlbGVjdGVkU29mdHdhcmVcbiAgICAgICAgLm1hcChpdGVtID0+IGl0ZW0uc29mdHdhcmUuYzh5X0ZpbHRlciAmJiBpdGVtLnNvZnR3YXJlLmM4eV9GaWx0ZXIudHlwZSlcbiAgICAgICAgLmZpbHRlcih0eXBlID0+ICEhdHlwZSlcbiAgICApO1xuICB9XG59XG4iXX0=