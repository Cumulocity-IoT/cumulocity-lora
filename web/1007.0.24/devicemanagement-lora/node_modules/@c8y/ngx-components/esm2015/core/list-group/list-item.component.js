import * as tslib_1 from "tslib";
import { Component, ContentChild, ElementRef, ContentChildren, HostBinding, Input, Output, EventEmitter, QueryList } from '@angular/core';
import { Subject } from 'rxjs';
import { takeUntil, filter, tap, delay } from 'rxjs/operators';
import { ListItemActionComponent } from './list-item-action.component';
import { ListItemCollapseComponent } from './list-item-collapse.component';
import { ListItemFooterComponent } from './list-item-footer.component';
let ListItemComponent = class ListItemComponent {
    constructor(element) {
        this.element = element;
        this.active = false;
        this.collapsed = true;
        this.collapsedChange = new EventEmitter();
        this.showFooter = false;
        this.showActions = false;
        this.showCollapse = false;
        this.dropdownUp = false;
        this.pulse$ = new Subject();
        this.destroy$ = new Subject();
        this.ACTION_ITEM_HEIGHT = 40;
    }
    ngOnInit() {
        this.pulse$.pipe(filter(apply => !!apply), tap(() => this.element.nativeElement.classList.remove('c8y-list--pulse')), delay(100), tap(() => this.element.nativeElement.classList.add('c8y-list--pulse')), takeUntil(this.destroy$)).subscribe();
    }
    ngAfterContentChecked() {
        this.actions = this.itemActions.toArray();
        this.showFooter = this.itemFooter != null;
        this.showActions = this.itemActions.length > 0;
        this.showCollapse = this.itemCollapse != null;
    }
    ngOnDestroy() {
        this.destroy$.next();
        this.destroy$.complete();
    }
    /**
     * A helper function which helps to determine if the dropdown
     * should toggle up.
     */
    showDropdownUp() {
        const rect = this.element.nativeElement.getBoundingClientRect();
        this.dropdownUp =
            rect.bottom + this.itemActions.length * this.ACTION_ITEM_HEIGHT > window.innerHeight;
    }
    /**
     * Toggles the collapse state and emits this state as
     * collapsedChange output as boolean.
     */
    toggleCollapsed() {
        this.collapsed = !this.collapsed;
        this.collapsedChange.emit(this.collapsed);
    }
    /**
     * Highlights the list-item. This method should be used to show the
     * user that something within this item was changed.
     */
    pulse() {
        this.pulse$.next(true);
    }
};
ListItemComponent.ctorParameters = () => [
    { type: ElementRef }
];
tslib_1.__decorate([
    Input(),
    HostBinding('class.active')
], ListItemComponent.prototype, "active", void 0);
tslib_1.__decorate([
    Input()
], ListItemComponent.prototype, "collapsed", void 0);
tslib_1.__decorate([
    Output()
], ListItemComponent.prototype, "collapsedChange", void 0);
tslib_1.__decorate([
    ContentChild(ListItemFooterComponent, { static: false })
], ListItemComponent.prototype, "itemFooter", void 0);
tslib_1.__decorate([
    ContentChildren(ListItemActionComponent)
], ListItemComponent.prototype, "itemActions", void 0);
tslib_1.__decorate([
    ContentChild(ListItemCollapseComponent, { static: false })
], ListItemComponent.prototype, "itemCollapse", void 0);
ListItemComponent = tslib_1.__decorate([
    Component({
        selector: 'c8y-list-item, c8y-li',
        template: "<div [ngClass]=\"{ 'expanded': !collapsed }\">\n  <div class=\"c8y-list__item__block\">\n    <ng-content select=\"c8y-list-item-radio, c8y-li-radio\"></ng-content>\n    <ng-content select=\"c8y-list-item-checkbox, c8y-li-checkbox\"></ng-content>\n\n    <ng-content select=\"c8y-list-item-icon, c8y-li-icon\"></ng-content>\n\n    <div class=\"c8y-list__item__body text-truncate-wrap\">\n      <ng-content select=\"c8y-list-item-body, c8y-li-body\"></ng-content>\n      <ng-content></ng-content>\n      <div class=\"c8y-list__item__footer\" *ngIf=\"showFooter\">\n        <ng-content select=\"c8y-list-item-footer, c8y-li-footer\"></ng-content>\n      </div>\n    </div>\n\n    <div class=\"c8y-list__item__actions\" *ngIf=\"showCollapse || showActions\">\n      <button\n        class=\"collapse-btn\"\n        title=\"{{ 'Expand' | translate }}\"\n        type=\"button\"\n        (click)=\"toggleCollapsed()\"\n        [attr.aria-expanded]=\"!collapsed\"\n        *ngIf=\"showCollapse\"\n      >\n        <i [c8yIcon]=\"'chevron-down'\"></i>\n      </button>\n      <div\n        class=\"dropdown\"\n        dropdown\n        [dropup]=\"dropdownUp\"\n        *ngIf=\"showActions\"\n        (onShown)=\"showDropdownUp()\"\n      >\n        <button\n          class=\"dropdown-toggle c8y-dropdown\"\n          dropdownToggle\n          title=\"{{ 'Actions' | translate }}\"\n          type=\"button\"\n          aria-haspopup=\"true\"\n        >\n          <i [c8yIcon]=\"'ellipsis-v'\"></i>\n        </button>\n        <ul class=\"dropdown-menu dropdown-menu-right\" *dropdownMenu>\n          <ng-content select=\"c8y-list-item-action, c8y-li-action\"></ng-content>\n          <ng-container *ngFor=\"let action of actions\">\n            <ng-container *ngTemplateOutlet=\"action.template\"></ng-container>\n          </ng-container>\n        </ul>\n      </div>\n\n      <ng-content select=\"c8y-list-item-action, c8y-li-action\" *ngIf=\"showActions\"></ng-content>\n    </div>\n  </div>\n\n  <div *ngIf=\"showCollapse\" [collapse]=\"collapsed\" [isAnimated]=\"true\">\n    <div class=\"c8y-list__item__collapse--container\">\n      <ng-content select=\"c8y-list-item-collapse, c8y-li-collapse\"></ng-content>\n    </div>\n  </div>\n</div>\n",
        host: {
            class: 'c8y-list__item'
        }
    })
], ListItemComponent);
export { ListItemComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGlzdC1pdGVtLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BjOHkvbmd4LWNvbXBvbmVudHMvIiwic291cmNlcyI6WyJjb3JlL2xpc3QtZ3JvdXAvbGlzdC1pdGVtLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUNMLFNBQVMsRUFDVCxZQUFZLEVBQ1osVUFBVSxFQUNWLGVBQWUsRUFDZixXQUFXLEVBQ1gsS0FBSyxFQUNMLE1BQU0sRUFDTixZQUFZLEVBQ1osU0FBUyxFQUNWLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDL0IsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLEVBQUUsR0FBRyxFQUFFLEtBQUssRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQy9ELE9BQU8sRUFBRSx1QkFBdUIsRUFBRSxNQUFNLDhCQUE4QixDQUFDO0FBQ3ZFLE9BQU8sRUFBRSx5QkFBeUIsRUFBRSxNQUFNLGdDQUFnQyxDQUFDO0FBQzNFLE9BQU8sRUFBRSx1QkFBdUIsRUFBRSxNQUFNLDhCQUE4QixDQUFDO0FBU3ZFLElBQWEsaUJBQWlCLEdBQTlCLE1BQWEsaUJBQWlCO0lBeUI1QixZQUFtQixPQUFtQjtRQUFuQixZQUFPLEdBQVAsT0FBTyxDQUFZO1FBdEJ0QyxXQUFNLEdBQVksS0FBSyxDQUFDO1FBRXhCLGNBQVMsR0FBWSxJQUFJLENBQUM7UUFFMUIsb0JBQWUsR0FBRyxJQUFJLFlBQVksRUFBVyxDQUFDO1FBUTlDLGVBQVUsR0FBWSxLQUFLLENBQUM7UUFDNUIsZ0JBQVcsR0FBWSxLQUFLLENBQUM7UUFDN0IsaUJBQVksR0FBWSxLQUFLLENBQUM7UUFFOUIsZUFBVSxHQUFZLEtBQUssQ0FBQztRQUVwQixXQUFNLEdBQXFCLElBQUksT0FBTyxFQUFXLENBQUM7UUFDbEQsYUFBUSxHQUFpQixJQUFJLE9BQU8sRUFBRSxDQUFDO1FBQzlCLHVCQUFrQixHQUFHLEVBQUUsQ0FBQztJQUVBLENBQUM7SUFFMUMsUUFBUTtRQUNOLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsRUFDekMsR0FBRyxDQUFDLEdBQUcsRUFBRSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsYUFBYSxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsQ0FBQyxFQUN6RSxLQUFLLENBQUMsR0FBRyxDQUFDLEVBQ1YsR0FBRyxDQUFDLEdBQUcsRUFBRSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsYUFBYSxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsaUJBQWlCLENBQUMsQ0FBQyxFQUN0RSxTQUFTLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsU0FBUyxFQUFFLENBQUM7SUFDeEMsQ0FBQztJQUVELHFCQUFxQjtRQUNuQixJQUFJLENBQUMsT0FBTyxHQUFHLElBQUksQ0FBQyxXQUFXLENBQUMsT0FBTyxFQUFFLENBQUM7UUFDMUMsSUFBSSxDQUFDLFVBQVUsR0FBRyxJQUFJLENBQUMsVUFBVSxJQUFJLElBQUksQ0FBQztRQUMxQyxJQUFJLENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQyxXQUFXLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQztRQUMvQyxJQUFJLENBQUMsWUFBWSxHQUFHLElBQUksQ0FBQyxZQUFZLElBQUksSUFBSSxDQUFDO0lBQ2hELENBQUM7SUFFRCxXQUFXO1FBQ1QsSUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLEVBQUUsQ0FBQztRQUNyQixJQUFJLENBQUMsUUFBUSxDQUFDLFFBQVEsRUFBRSxDQUFDO0lBQzNCLENBQUM7SUFFRDs7O09BR0c7SUFDSCxjQUFjO1FBQ1osTUFBTSxJQUFJLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxhQUFhLENBQUMscUJBQXFCLEVBQUUsQ0FBQztRQUNoRSxJQUFJLENBQUMsVUFBVTtZQUNiLElBQUksQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDLGtCQUFrQixHQUFHLE1BQU0sQ0FBQyxXQUFXLENBQUM7SUFDekYsQ0FBQztJQUVEOzs7T0FHRztJQUNILGVBQWU7UUFDYixJQUFJLENBQUMsU0FBUyxHQUFHLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQztRQUNqQyxJQUFJLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7SUFDNUMsQ0FBQztJQUVEOzs7T0FHRztJQUNILEtBQUs7UUFDSCxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUN6QixDQUFDO0NBQ0YsQ0FBQTs7WUFoRDZCLFVBQVU7O0FBdEJ0QztJQUZDLEtBQUssRUFBRTtJQUNQLFdBQVcsQ0FBQyxjQUFjLENBQUM7aURBQ0o7QUFFeEI7SUFEQyxLQUFLLEVBQUU7b0RBQ2tCO0FBRTFCO0lBREMsTUFBTSxFQUFFOzBEQUNxQztBQUU5QztJQURDLFlBQVksQ0FBQyx1QkFBdUIsRUFBRSxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUUsQ0FBQztxREFDckI7QUFFcEM7SUFEQyxlQUFlLENBQUMsdUJBQXVCLENBQUM7c0RBQ087QUFFaEQ7SUFEQyxZQUFZLENBQUMseUJBQXlCLEVBQUUsRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLENBQUM7dURBQ25CO0FBYjdCLGlCQUFpQjtJQVA3QixTQUFTLENBQUM7UUFDVCxRQUFRLEVBQUUsdUJBQXVCO1FBQ2pDLDZzRUFBeUM7UUFDekMsSUFBSSxFQUFFO1lBQ0osS0FBSyxFQUFFLGdCQUFnQjtTQUN4QjtLQUNGLENBQUM7R0FDVyxpQkFBaUIsQ0F5RTdCO1NBekVZLGlCQUFpQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIENvbXBvbmVudCxcbiAgQ29udGVudENoaWxkLFxuICBFbGVtZW50UmVmLFxuICBDb250ZW50Q2hpbGRyZW4sXG4gIEhvc3RCaW5kaW5nLFxuICBJbnB1dCxcbiAgT3V0cHV0LFxuICBFdmVudEVtaXR0ZXIsXG4gIFF1ZXJ5TGlzdFxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IFN1YmplY3QgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IHRha2VVbnRpbCwgZmlsdGVyLCB0YXAsIGRlbGF5IH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuaW1wb3J0IHsgTGlzdEl0ZW1BY3Rpb25Db21wb25lbnQgfSBmcm9tICcuL2xpc3QtaXRlbS1hY3Rpb24uY29tcG9uZW50JztcbmltcG9ydCB7IExpc3RJdGVtQ29sbGFwc2VDb21wb25lbnQgfSBmcm9tICcuL2xpc3QtaXRlbS1jb2xsYXBzZS5jb21wb25lbnQnO1xuaW1wb3J0IHsgTGlzdEl0ZW1Gb290ZXJDb21wb25lbnQgfSBmcm9tICcuL2xpc3QtaXRlbS1mb290ZXIuY29tcG9uZW50JztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnYzh5LWxpc3QtaXRlbSwgYzh5LWxpJyxcbiAgdGVtcGxhdGVVcmw6ICcuL2xpc3QtaXRlbS5jb21wb25lbnQuaHRtbCcsXG4gIGhvc3Q6IHtcbiAgICBjbGFzczogJ2M4eS1saXN0X19pdGVtJ1xuICB9XG59KVxuZXhwb3J0IGNsYXNzIExpc3RJdGVtQ29tcG9uZW50IHtcbiAgQElucHV0KClcbiAgQEhvc3RCaW5kaW5nKCdjbGFzcy5hY3RpdmUnKVxuICBhY3RpdmU6IGJvb2xlYW4gPSBmYWxzZTtcbiAgQElucHV0KClcbiAgY29sbGFwc2VkOiBib29sZWFuID0gdHJ1ZTtcbiAgQE91dHB1dCgpXG4gIGNvbGxhcHNlZENoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXI8Ym9vbGVhbj4oKTtcbiAgQENvbnRlbnRDaGlsZChMaXN0SXRlbUZvb3RlckNvbXBvbmVudCwgeyBzdGF0aWM6IGZhbHNlIH0pXG4gIGl0ZW1Gb290ZXI6IExpc3RJdGVtRm9vdGVyQ29tcG9uZW50O1xuICBAQ29udGVudENoaWxkcmVuKExpc3RJdGVtQWN0aW9uQ29tcG9uZW50KVxuICBpdGVtQWN0aW9uczogUXVlcnlMaXN0PExpc3RJdGVtQWN0aW9uQ29tcG9uZW50PjtcbiAgQENvbnRlbnRDaGlsZChMaXN0SXRlbUNvbGxhcHNlQ29tcG9uZW50LCB7IHN0YXRpYzogZmFsc2UgfSlcbiAgaXRlbUNvbGxhcHNlOiBMaXN0SXRlbUNvbGxhcHNlQ29tcG9uZW50O1xuXG4gIHNob3dGb290ZXI6IGJvb2xlYW4gPSBmYWxzZTtcbiAgc2hvd0FjdGlvbnM6IGJvb2xlYW4gPSBmYWxzZTtcbiAgc2hvd0NvbGxhcHNlOiBib29sZWFuID0gZmFsc2U7XG4gIGFjdGlvbnM6IExpc3RJdGVtQWN0aW9uQ29tcG9uZW50W107XG4gIGRyb3Bkb3duVXA6IGJvb2xlYW4gPSBmYWxzZTtcblxuICBwcml2YXRlIHB1bHNlJDogU3ViamVjdDxib29sZWFuPiA9IG5ldyBTdWJqZWN0PGJvb2xlYW4+KCk7XG4gIHByaXZhdGUgZGVzdHJveSQ6IFN1YmplY3Q8YW55PiA9IG5ldyBTdWJqZWN0KCk7XG4gIHByaXZhdGUgcmVhZG9ubHkgQUNUSU9OX0lURU1fSEVJR0hUID0gNDA7XG5cbiAgY29uc3RydWN0b3IocHVibGljIGVsZW1lbnQ6IEVsZW1lbnRSZWYpIHt9XG5cbiAgbmdPbkluaXQoKTogdm9pZCAge1xuICAgIHRoaXMucHVsc2UkLnBpcGUoZmlsdGVyKGFwcGx5ID0+ICEhYXBwbHkpLFxuICAgIHRhcCgoKSA9PiB0aGlzLmVsZW1lbnQubmF0aXZlRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdjOHktbGlzdC0tcHVsc2UnKSksXG4gICAgZGVsYXkoMTAwKSxcbiAgICB0YXAoKCkgPT4gdGhpcy5lbGVtZW50Lm5hdGl2ZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnYzh5LWxpc3QtLXB1bHNlJykpLFxuICAgIHRha2VVbnRpbCh0aGlzLmRlc3Ryb3kkKSkuc3Vic2NyaWJlKCk7XG4gIH1cblxuICBuZ0FmdGVyQ29udGVudENoZWNrZWQoKTogdm9pZCB7XG4gICAgdGhpcy5hY3Rpb25zID0gdGhpcy5pdGVtQWN0aW9ucy50b0FycmF5KCk7XG4gICAgdGhpcy5zaG93Rm9vdGVyID0gdGhpcy5pdGVtRm9vdGVyICE9IG51bGw7XG4gICAgdGhpcy5zaG93QWN0aW9ucyA9IHRoaXMuaXRlbUFjdGlvbnMubGVuZ3RoID4gMDtcbiAgICB0aGlzLnNob3dDb2xsYXBzZSA9IHRoaXMuaXRlbUNvbGxhcHNlICE9IG51bGw7XG4gIH1cblxuICBuZ09uRGVzdHJveSgpIHtcbiAgICB0aGlzLmRlc3Ryb3kkLm5leHQoKTtcbiAgICB0aGlzLmRlc3Ryb3kkLmNvbXBsZXRlKCk7XG4gIH1cblxuICAvKipcbiAgICogQSBoZWxwZXIgZnVuY3Rpb24gd2hpY2ggaGVscHMgdG8gZGV0ZXJtaW5lIGlmIHRoZSBkcm9wZG93blxuICAgKiBzaG91bGQgdG9nZ2xlIHVwLlxuICAgKi9cbiAgc2hvd0Ryb3Bkb3duVXAoKSB7XG4gICAgY29uc3QgcmVjdCA9IHRoaXMuZWxlbWVudC5uYXRpdmVFbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgIHRoaXMuZHJvcGRvd25VcCA9XG4gICAgICByZWN0LmJvdHRvbSArIHRoaXMuaXRlbUFjdGlvbnMubGVuZ3RoICogdGhpcy5BQ1RJT05fSVRFTV9IRUlHSFQgPiB3aW5kb3cuaW5uZXJIZWlnaHQ7XG4gIH1cblxuICAvKipcbiAgICogVG9nZ2xlcyB0aGUgY29sbGFwc2Ugc3RhdGUgYW5kIGVtaXRzIHRoaXMgc3RhdGUgYXNcbiAgICogY29sbGFwc2VkQ2hhbmdlIG91dHB1dCBhcyBib29sZWFuLlxuICAgKi9cbiAgdG9nZ2xlQ29sbGFwc2VkKCkge1xuICAgIHRoaXMuY29sbGFwc2VkID0gIXRoaXMuY29sbGFwc2VkO1xuICAgIHRoaXMuY29sbGFwc2VkQ2hhbmdlLmVtaXQodGhpcy5jb2xsYXBzZWQpO1xuICB9XG5cbiAgLyoqXG4gICAqIEhpZ2hsaWdodHMgdGhlIGxpc3QtaXRlbS4gVGhpcyBtZXRob2Qgc2hvdWxkIGJlIHVzZWQgdG8gc2hvdyB0aGVcbiAgICogdXNlciB0aGF0IHNvbWV0aGluZyB3aXRoaW4gdGhpcyBpdGVtIHdhcyBjaGFuZ2VkLlxuICAgKi9cbiAgcHVsc2UoKSB7XG4gICAgdGhpcy5wdWxzZSQubmV4dCh0cnVlKTtcbiAgfVxufVxuIl19