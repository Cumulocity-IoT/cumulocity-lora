"use strict";function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}!function(){e.$inject=["c8yBase","c8yUser","c8yInventory","c8yExportApis","c8yExportFilters","gettext","gettextCatalog"],angular.module("c8y.cockpit.export").service("exportConfig",e);var u="c8y_ExportConfiguration",m={name:"",exportType:"csv",queryParameters:{},apiList:[]};function e(t,e,n,r,a,i,o){var s=[{name:"source",label:i("Object to export"),template:":::PLUGIN_PATH:::/views/filters/source.html",def:[a.SourceFilter,"source"]},{name:"dateType",label:i("Time range"),template:":::PLUGIN_PATH:::/views/filters/dateRange.html",def:[a.DateRangeFilter,"dateType"]}],c=[{name:"Alarms",icon:"bell",label:i("Alarms"),def:[r.Api,"Alarms"]},{name:"Events",icon:"rss",label:i("Events"),def:[r.Api,"Events"]},{name:"ManagedObjects",icon:"cubes",label:i("Managed objects"),def:[r.Api,"ManagedObjects"]},{name:"Measurements",icon:"bar-chart-o",label:i("Measurements"),def:[r.MeasurementsApi],template:":::PLUGIN_PATH:::/views/apis/measurements.html"}];function l(e){for(var t=arguments.length,i=new Array(1<t?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return _.map(e,function(e){var t,n=e.def,r=_.tail(n),a=new((t=_).bind.apply(t,_toConsumableArray([n[0],n[0]].concat(r).concat(i))));return _.assign(a,_.omit(e,"def","name")),a})}this.getFilters=function(e,t){return l(s,e,t)},this.getApis=function(e){return l(c,e)},this.getFileTypes=function(){return[{name:"CSV",type:"csv"},{name:"Excel (.xlsx)",type:"vnd.ms-excel"}]},this.list=function(){return n.list({fragmentType:u})},this.create=function(e){return _.merge(_.cloneDeep(m),e)},this.detail=function(e){return n.detail(e).then(t.getResData)},this.save=function(e){return e.id?n.save(e).then(function(){return e}):(e[u]={},n.createConfirm(e).then(t.getResData))},this.remove=function(e){return n.remove(e.id)},this.getSmartRuleDefaults=function(t){return e.current().then(function(e){return{name:o.getString('Send "{{name}}" via email',t),c8y_Context:{context:"exportConfiguration",id:t.id},config:{exportConfiguration:_.pick(t,["id","name"]),exportConfigurationId:t.id,to:e.email,subject:o.getString('Export of "{{name}}"',t)}}})}}}();