"use strict";function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t)){for(var r=0,n=new Array(t.length);r<t.length;r++)n[r]=t[r];return n}}!function(){function t(i,n,t,a,u){return{requestExport:function(t){var r=(_.isArray(t)?t:[t]).map(function(t){return n({method:"GET",url:"/export/exports",params:{configurationId:t}})});return i.all(r)},convertToSchedules:function(o){var n=function(t){return(t||"").split(",")},c=function(t){var r=new Date(t.creationTime);return{timestamp:r.getTime(),emailConfig:{to:n(t.config.to),cc:n(t.config.cc),bcc:n(t.config.bcc),replyTo:t.config.replyTo||"",subject:t.config.subject||"",text:t.config.text||""},cronConfig:{month:t.config.month||"*",day:t.config.day||"*",weekday:t.config.weekday||"*",hour:t.config.hour||"*",minute:t.config.minute||"*",second:t.config.second||"*"}}};return i.all({exportObj:a.detail(o).then(t.getResData),rules:u.listByContext(o)}).then(function(t){var r=t.exportObj,n=t.rules,e=r.c8y_ScheduleConfiguration||[];return function(t){return a.update({id:o,c8y_ScheduleConfiguration:t})}(e=[].concat(_toConsumableArray(e),_toConsumableArray(_.map(n,c)))).then(function(){return function(t){return i.all(_.map(t,function(t){return u.remove(t)}))}(n)})})}}}t.$inject=["$q","$http","c8yBase","c8yInventory","smartRulesSvc"],angular.module("c8y.cockpit.export").factory("exportService",t)}();