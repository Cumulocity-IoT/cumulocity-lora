"use strict";function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?Object(arguments[e]):{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(e){_defineProperty(t,e,r[e])})}return t}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}!function(){function e(n,o,i,c,a,e,u,t){var l=t.ALL_DEVICES_COLUMNS_META_USER_PREFERENCES_KEY_PREFIX,f=t.FILTERING_MODE;return{popupModalColumnsConfigure:function(e){var t=e.dynamicGroupId,r=e.columnOptions;return a({component:"c8yModalDeviceListColumnsConfigure",resolve:{dynamicGroupId:function(){return t},columnOptions:function(){return r}}})},getConfigurableColumns:function(e){var t=e.dynamicGroupId,r=e.options;return(_.isString(t)?o.getConfigurableColumnsMeta(t):n.get(l)).then(function(e){return _.isEmpty(e)?function(e){return _.map(i.getParentDeviceColumns(e),function(e){return _objectSpread({},e,{meta:{key:e.name,headerName:e.header,active:!0}})})}(r):_.map(e,function(e){return m({meta:e,options:r})})}).then(g)},createConfigurableColumn:m,moveRemovalColumnToTheEnd:g,saveConfigurableColumnsMeta:function(e){var t=e.dynamicGroupId,r=e.configurableColumns;return _.isString(t)?o.saveConfigurableColumnsMeta(t,r):n.set(l,_.map(r,"meta"))}};function m(e){var t=e.meta,r=e.options;if(t.custom){var n,o=(_defineProperty(n={},f.EQUALITY,s),_defineProperty(n,f.EXISTENCE,p),n)[t.filteringMode];if(!_.isFunction(o))throw new Error("Invalid filtering mode.");return _objectSpread({},o(t),{meta:t})}var a=i.getParentDeviceColumns(r);return _objectSpread({},_.find(a,{name:t.key}),{meta:t})}function s(e){var t=e.key,r=e.headerName,n=e.fragmentPath,o=_.lowerCase(r),a="".concat(t,"s");return _objectSpread({},y(e),{filtering:{schema:{type:"object",properties:_defineProperty({},a,{type:"array",items:{type:"string"}})},form:[{key:a,title:u.getString('Show devices where "{{headerName}}" contains:',{headerName:r}),add:u.getString("Or"),items:[{key:"".concat(a,"[]"),notitle:!0,placeholder:u.getString("e.g. value, you can use an asterisk (*) as wildcard character",{lowerCasedName:o})}]}],getFilter:function(e){return c.getInFilterFromModel(a,n,e)}},sorting:{path:n}})}function p(e){var t=e.key,r=e.fragmentPath,n=t;return _objectSpread({},y(e),{filtering:{schema:{type:"object",properties:_defineProperty({},n,{type:"boolean",default:!1,title:u.getString('Check for the existence of "{{fragmentPath}}" fragment',{fragmentPath:r})})},form:["*"],getFilter:function(e){return e[n]?{__has:r}:{}}}})}function y(e){var t=e.key,r=e.headerName,n=e.fragmentPath,o="getFragmentPathValue_".concat(t),a=_.property(n);return{name:t,header:r,cell:{template:'<span ng-bind="'.concat(o,'(item)"></span>'),scopeExtensions:_defineProperty({},o,a)}}}function g(e){var t=_.find(e,{name:"removalColumn"});return[].concat(_toConsumableArray(_.without(e,t)),[t])}}e.$inject=["c8yUserPreferences","c8yDynamicGroups","c8yDeviceListColumns","c8yFilteringSortingInventoryQueries","c8yModal","c8yAlert","gettextCatalog","c8yConfigurableDeviceListColumnsConstants"],angular.module("c8y.ui").factory("c8yConfigurableDeviceListColumns",e)}();